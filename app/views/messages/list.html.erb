<h1>Messages</h1>

<table>
	<tr>
		<td>Title</td>
		<td>User</td>
	</tr>
	
	<% @messages.select{|data_item| data_item[:reply_to_message_id] == nil}.each do |message| %>
		<% user = @users.select{|data_item| data_item[:id] == message[:user_id]}.first %>
		<tr>
			<td><%= link_to message[:title], "/messages/" + message[:id].to_s %></td>
			<% p user %>
			<td><%= user[:first_name]%> <%= user[:last_name] %></td>
		</tr>

	<% end %>

	<%= link_to "New Message", "/messages/new" %>
</table>